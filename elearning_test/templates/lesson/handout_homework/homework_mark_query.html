<script>
    $(document).ready(function(){
        /* 儲存與送出分數 */
        $(".submit_score").click(function(even){
            even.preventDefault();
            var form = $("#form")[0];
            var formdata = new FormData(form);
            $.ajax({})

        ;})

        /* 展開附檔清單 */
        $(".attach_file_open").click(function(even){
            /* 抓取資料 */
            var query_id = even.target.value;
            $("#mask").load("ajax_show/homework_attachfile_query?hw_submit_id=" + query_id);
            /* 展開遮罩 */
            $("#mask").show("slow");
        ;})
    ;})
</script>

{%if query_success%}
<table class="table table-hover" style="table-layout:fixed;">
    <thead>
        <tr>
            <th width="10%">繳交人</th>
            <th width="20%">最後繳交時間</th>
            <th>說明</th>
            <th width="10%">附檔</th>
            <th width="20%">評分</th>
        </tr>
    </thead>
    <tbody>
        {%for item in hw_submit_info%}
        <tr>
            <td>{{item.last_name}}{{item.first_name}}</td>
            <td>{{item.submit_time}}</td>
            <td style="overflow:hidden; text-overflow:ellipsis">{{item.submitinfo}}</td>
            <td>
                {%if item.attach_file_exist%}
                <button class="btn btn-primary attach_file_open" type="button" value="{{item.inner_id}}">展開</button>
                {%endif%}
                <div>
                {%for attach_file in db|hw_submit_file:item.inner_id%}
                {%endfor%}
                </div>
            </td>
            <td>
                <form id="{{item.inner_id}}_score_form" method="post">
                    {%csrf_token%}
                    <div class="row">
                        <input name="{{item.inner_id}}_score" type="number" min="0" max="100" class="form-control col mx-1">
                        <button class="submit_score btn btn-success col-6 mx-1" type="submit">送出分數</button>
                    </div>
                </form>
            </td>
        </tr>
    {%endfor%}
    </tbody>
</table>
{%else%}
<h4>查無作業</h4>
{%endif%}